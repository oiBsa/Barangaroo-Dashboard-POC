{% load static %}
<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <!-- My CSS -->
  <link rel="stylesheet" href="{% static 'admin/css/style2.css' %}">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-latest.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"
    integrity="sha512-SGWgwwRA8xZgEoKiex3UubkSkV1zSE1BS6O4pXcaxcNtUlQsOmOmhVnDwIvqGRfEmuz83tIGL13cXMZn6upPyg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>

  <title>Thermal Comfort</title>
</head>

<body>


  <!-- SIDEBAR -->
  <section id="sidebar" class="hide">
    <a href="#" class="brand">
      <img class="oi-icon"
        src="https://media-exp1.licdn.com/dms/image/C560BAQEAPjKix24H5A/company-logo_200_200/0/1574388135440?e=1672272000&v=beta&t=SBjMJWO6LihSvjdzM88Lvk15riwX8TkLhz_SNQhDWDw"
        alt="Operational Interlligence">
      <span class="text">Operational Intelligence</span>
    </a>
  </section>
  <!-- SIDEBAR -->



  <!-- CONTENT -->
  <section id="content" style="background-color: white;">
    <!-- NAVBAR -->
    <nav style="height: 52px;">
      <a href="#" class="nav-link">Thermal Comfort</a>
    </nav>
    <!-- NAVBAR -->

    <!-- MAIN -->
    <main id="TCD">
      <div id="thermalComfortDashboard">
        <!-- Heading -->
        <div class="headings">
          <p>
            Thermal
          </p>
          <p>
            <span>
              Comfort
            </span>
            <span class="dashboard">
              Dashboard
            </span>
          </p>
        </div>
        <!-- Heading -->

        <!-- TCD Main Content -->
        <div class="thermalComfortContent">
          <div class="gaugeConinter">
            <div>
              <p>Percentage of Rooms<br>Below
                <input value="22.5" id="belowTempThresh"
                  style='text-decoration: underline; text-decoration-color: #B4B1C9;'></input>&deg;C
              </p>
              <div id="TCDgauge" class="belowButton">
                <div id="gaugecontainers1" style="width: 300px; height: 300px; margin: 0 auto">
                </div>
                <button id="center-circle" style="border:none;" class='btn gaugeBelowClick' data-toggle="modal"
                  data-target="#myModal" label='below'>
                  <span id="belowAvg" class="TCDgaugeValue">65%</span>
                </button>
                <div class="modal" id="myModal">
                  <div class="modal-dialog">
                    <div class="modal-content" style="min-width:30vw;border-radius:20px;padding:5px 5px;">

                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Equipment Temperature</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>

                      <!-- Modal body -->
                      <div class="modal-body" style="max-height:50vh; overflow-y:auto;">
                        <table class="table table-striped" id="table">
                          <thead>
                            <tr>
                              <th>Equipment</th>
                              <th>Temperature</th>
                            </tr>
                          </thead>
                          <tbody id='dialog-tbody'>
                            <tr>
                              <td> Please wait....</td>
                              <td> <i class="bx bx-loader-alt bx-spin"></i> </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>

                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>

                    </div>
                  </div>
                </div>

              </div>
            </div>
            <div>
              <p>Percentage of Rooms<br>Above
                <input value="24.2" id="aboveTempThresh"
                  style='text-decoration: underline; text-decoration-color: #B4B1C9;'></input>&deg;C
              </p>
              <div id="TCDgauge" class='aboveButton'>
                <div id="gaugecontainers2" style="width: 300px; height: 300px; margin: 0 auto">
                </div>
                <button id="center-circle" style="border:none;" class='btn gaugeAboveClick' data-toggle="modal"
                  data-target="#myModal" label='above'>
                  <span id="aboveAvg" class="TCDgaugeValue">35%</span>
                </button>
              </div>
            </div>
          </div>
          <div>
            <canvas id="TDCgraph" style="height: 100px;">
            </canvas>
          </div>
        </div>


        <!-- TCD Main Content -->
      </div>
      <div id="thermalComfortSideBar">
        <div class="heading">
          <h4>
            Monitoring
          </h4>
        </div>
        <div id="thermalComfortSideBarSelection">
          <div class="selectionContainer active">
            <div style="display:flex">
              <a class='bx' id="box1" href="{% url 'thermalComfort' %}">
                <span>&deg;C</span>
              </a>
              <div style="margin-left:20px;" class="selectionLabel">
                Temperature
              </div>
            </div>
          </div>
          <div class="selectionContainer">
            <div style="display:flex">
              <a class='bx' id="box2" href="{% url 'thermalComfortHumidity' %}">
                <span>%</span>
              </a>
              <div style="margin-left:20px;" class="selectionLabel">
                Humidity
              </div>
            </div>
          </div>
          <div class="selectionContainer">
            <div style="display:flex">
              <a class='bx' id="box3" href="{% url 'thermalComfortCo2' %}">
                <span>Co2</span>
              </a>
              <div style="margin-left:20px;" class="selectionLabel">
                Carbon Dioxide
              </div>
            </div>
          </div>
        </div>
        <div id="thermalComfortSideBarDropDown">
          <p id="thermalComfortAll">Thermal Comfort For All</p>
          <form name="form" action="">
            <ul name="toys" id="levels" size="6">
              <li value="1">PCF-ME-01-FCU-C3-012</li>
              <li value="2">PCF-ME-01-FCU-C3-076</li>
              <li value="3">PCF-ME-01-FCU-C3-004</li>
              <li value="4">PCF-ME-01-FCU-C3-078</li>
              <li value="5">PCF-ME-01-FCU-C3-012</li>
              <li value="6">PCF-ME-01-FCU-C3-076</li>
              <li value="7">PCF-ME-01-FCU-C3-004</li>
              <li value="8">PCF-ME-01-FCU-C3-078</li>
              <li value="9">PCF-ME-01-FCU-C3-012</li>
              <li value="10">PCF-ME-01-FCU-C3-076</li>
              <li value="11">PCF-ME-01-FCU-C3-004</li>
              <li value="12">PCF-ME-01-FCU-C3-078</li>
              <li value="14">PCF-ME-01-FCU-C3-012</li>
              <li value="15">PCF-ME-01-FCU-C3-076</li>
              <li value="16">PCF-ME-01-FCU-C3-004</li>
              <li value="17">PCF-ME-01-FCU-C3-078</li>
              <li value="18">PCF-ME-01-FCU-C3-012</li>
            </ul>
          </form>
        </div>
      </div>
    </main>
    <!-- MAIN -->
  </section>
  <!-- CONTENT -->


  <script src="{% static 'admin/js/script.js' %}"></script>
  <script>
    var showData = 1;
    var meterName = document.getElementById("meterName");
    var meterDescription = document.getElementById('meterDescription');
    var xValues = ['12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', '24:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', '24:00'];
    var yValuesAbove = [22, 18, 15, 25, 10, 15, 22, 32, 22, 20, 14, 25, 20, 18, 14, 20, 18, 20, 22, 21, 30, 35, 20, 25, 21, 25];
    var yValuesBelow = [78, 82, 85, 75, 90, 23, 78, 68, 78, 80, 86, 75, 80, 78, 86, 80, 82, 80, 78, 79, 70, 65, 80, 75, 79, 75];
    var colorListAbove = new Array(yValuesAbove.length).fill('#e06666');
    var maxTemp = indexOfMax(yValuesAbove);
    var minTemp = indexOfMin(yValuesAbove);
    var colorListBelow = new Array(yValuesAbove.length).fill('#9b70ff');
    var maxTemp = indexOfMax(yValuesBelow);
    var minTemp = indexOfMin(yValuesBelow);

    function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
      var angleInRadians = (angleInDegrees - 180) * Math.PI / 180;

      return {
        x: centerX + (radius * Math.cos(angleInRadians)),
        y: centerY + (radius * Math.sin(angleInRadians))
      };
    };
    function indexOfMax(arr) {
      if (arr.length === 0) {
        return -1;
      }

      var max = arr[0];
      var maxIndex = 0;

      for (var i = 1; i < arr.length; i++) {
        if (arr[i] > max) {
          maxIndex = i;
          max = arr[i];
        }
      }

      return maxIndex;
    };
    function indexOfMin(arr) {
      var lowest = 0;
      for (var i = 1; i < arr.length; i++) {
        if (arr[i] < arr[lowest]) lowest = i;
      }
      return lowest;
    };
    function switchChannel(el) {
      // find all the elements in your channel list and loop over them
      Array.prototype.slice.call(document.querySelectorAll('ul[data-tag="channelList"] li')).forEach(function (element) {
        // remove the selected class
        element.classList.toggle('unselected');
      });
      // add the selected class to the element that was clicked
      this.classList.toggle('selected');
    }



    var ctx = document.getElementById('TDCgraph').getContext('2d');
    var chartConfig = {
      type: 'bar',
      data: {
        labels: xValues,
        datasets: [{
          label: "Above",
          data: yValuesAbove,
          backgroundColor: colorListAbove,
          borderRadius: 5,
        },
        {
          label: "Below",
          data: yValuesBelow,
          backgroundColor: colorListBelow,
          borderRadius: 5,
        }],

      },
      options: {
        plugins: {
          legend: {
            display: true,
            align: 'end',
            position: 'top',
          }
        },

        scales: {
          y: {
            grid: {
              display: false,
              drawBorder: true,
              drawTicks: true,
            },
            ticks: {
              display: true,
              callback: function (value, index, ticks) {
                return value + '%';
              }
            }
          },
          x: {
            type: 'category',
            grid: {
              display: false,
              drawBorder: true,
              drawTicks: true,
            },
          },
        },
        responsive: true,
      }

    };
    const gauge1 = Highcharts.chart('gaugecontainers1', {
      chart: { type: 'solidgauge', backgroundColor: '#FBFBFB', },
      tooltip: {
        borderWidth: 0,
        backgroundColor: 'none',
        shadow: false,
        style: { fontSize: '16px' },
        pointFormat: '{series.name}<br><span style="font-size:24px; color: {point.color}; font-weight: bold; text-align: center">{point.y} &deg;C</span>',
        positioner: function (labelWidth, labelHeight) {
          return { x: 160 - labelWidth / 2, y: 240 };
        }
      },

      pane: [{
        startAngle: -140,
        endAngle: 140,
        background: [{ // Track for Move
          outerRadius: '85%',
          innerRadius: '70%',
          backgroundColor: '#F1F0F5',
          borderWidth: 0,
          shape: 'arc'
        }, { // Track for Stand
          outerRadius: '70%',
          innerRadius: '0%',
          backgroundColor: Highcharts.getOptions().colors[2],
          borderWidth: 0,
          shape: 'arc'
        }]
      }, {
        startAngle: -140,
        endAngle: 140,
        size: '100%',
        background: []
      }],
      credits: {
        enabled: false
      },
      yAxis: [{
        min: 0,
        max: 50,
        lineWidth: 0,
        tickLength: 0,
        tickWidth: 6,
        tickColor: 'black',
        tickPosition: 'inside',
        minorTickLength: 8,
        tickPositions: [0, 10, 20, 30, 40, 50],
        labels: {
          distance: 20,
          enabled: true,
          x: 0,
          y: 0,
          format: '{value} &deg;C',
          style: {
            fontSize: 12,
            fontFamily: "sans-serif"
          }
        }

      }],
      title: {
        text: '',
      },

      plotOptions: {
        solidgauge: {
          borderWidth: '14px',
          dataLabels: {
            enabled: false
          },
          linecap: 'round',
          stickyTracking: false,
        }
      },

      series: [{
        name: 'Average',
        animation: false,
        borderColor: '#6F32FF',
        data: [{
          color: '#6F32FF',
          radius: '80%',
          innerRadius: '80%',
          y: 20
        }]
      },
      ]
    });
    const gauge2 = Highcharts.chart('gaugecontainers2', {
      chart: {
        backgroundColor: '#FBFBFB',
        type: 'solidgauge'
      },
      tooltip: {
        borderWidth: 0,
        backgroundColor: 'none',
        shadow: false,
        style: {
          fontSize: '16px'
        },
        pointFormat: '{series.name}<br><span style="font-size:24px; color: {point.color}; font-weight: bold; text-align: center">{point.y} &deg;C</span>',
        positioner: function (labelWidth, labelHeight) {
          return {
            x: 160 - labelWidth / 2,
            y: 240
          };
        }
      },

      pane: [{
        startAngle: -140,
        endAngle: 140,
        background: [{ // Track for Move
          outerRadius: '85%',
          innerRadius: '70%',
          backgroundColor: '#F1F0F5',
          borderWidth: 0,
          shape: 'arc'
        }, { // Track for Stand
          outerRadius: '70%',
          innerRadius: '0%',
          backgroundColor: '#FBFBFB',
          borderWidth: 0,
          shape: 'arc'
        }]
      }, {
        startAngle: -140,
        endAngle: 140,
        size: '100%',
        background: []
      }],
      credits: {
        enabled: false
      },

      yAxis: [{
        min: 0,
        max: 50,
        lineWidth: 0,
        tickLength: 0,
        tickWidth: 6,
        tickColor: 'black',
        tickPosition: 'inside',
        minorTickLength: 8,
        tickPositions: [0, 10, 20, 30, 40, 50],
        labels: {
          distance: 20,
          enabled: true,
          x: 0,
          y: 0,
          format: '{value} &deg;C',
          style: {
            fontSize: 12,
            fontFamily: "sans-serif"
          }
        }

      }],
      title: {
        text: '',
      },
      plotOptions: {
        solidgauge: {
          borderWidth: '14px',
          dataLabels: {
            enabled: false
          },
          linecap: 'round',
          stickyTracking: false,
        }
      },

      series: [{
        name: 'Average',
        animation: false,
        borderColor: '#e06666',
        data: [{
          color: '#e06666',
          radius: '82%',
          innerRadius: '82%',
          y: 25
        }]
      },
      ]
    });
    $('#levels').on("click", "li", function () {
      $(this).parent().find('li').removeClass('active');
      $(this).addClass('active');
      document.getElementById("thermalComfortAll").innerHTML = "Thermal Comfort For"
      gauge1.update({
        series: [{
          animation: false,
          data: [{ y: 22 }]
        }]
      }, true, false, false);
      gauge2.update({
        series: [{
          animation: false,
          data: [{ y: 25 }]
        }]
      }, true, false, false);
      document.getElementById("aboveAvg").innerHTML = "16%";
      document.getElementById("belowAvg").innerHTML = "84%";
      chartConfig.data.datasets[0].data = JSON.parse([11, 9, 10, 12, 8, 7, 2, 20, 22, 10, 8, 12, 5, 9, 6, 5, 9, 10, 11, 7, 15, 20, 15, 11, 9, 12])
      chartConfig.data.datasets[1].data = JSON.parse([89, 91, 90, 88, 92, 93, 98, 80, 78, 90, 92, 85, 95, 91, 94, 95, 91, 90, 89, 93, 85, 80, 85, 89, 91, 88])
      Chart1.update("active")

    });
    var Chart1 = new Chart(ctx, chartConfig);
    document.getElementById("tempratureAboveArc").setAttribute("d", describeArc(115, 115, 110, 0, 359));
    document.getElementById("tempratureBellowArc").setAttribute("d", describeArc(80, 80, 65, 0, 270));
  </script>
</body>

</html>